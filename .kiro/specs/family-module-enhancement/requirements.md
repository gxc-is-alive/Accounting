# 需求文档：家庭模块完善

## 简介

完善家庭记账模块，使用户能够在 PC 端和移动端查看家庭总余额、各成员账户信息和所有家庭交易记录。当前家庭模块存在 PC 端无法显示家庭概览、移动端页面空白等问题，需要修复并增强功能。

## 术语表

- **Family（家庭）**: 由多个用户组成的群组，共享家庭账目
- **Family_Overview（家庭概览）**: 展示家庭总资产、收支统计、成员贡献的汇总视图
- **Family_Assets（家庭资产）**: 所有家庭成员账户余额的汇总
- **Family_Transaction（家庭交易）**: 家庭成员的交易记录，基于成员加入时间统计
- **Member_Contribution（成员贡献）**: 各成员在家庭收支中的占比统计
- **FamilyOverviewCard（家庭概览卡片）**: 在首页展示家庭概览的 Vue 组件

## 需求

### 需求 1：家庭概览展示

**用户故事：** 作为一个家庭成员，我希望在首页能够看到家庭的整体财务概览，以便快速了解家庭财务状况。

#### 验收标准

1. WHEN 用户已加入家庭且访问首页 THEN FamilyOverviewCard SHALL 显示家庭概览信息
2. WHEN 用户未加入任何家庭 THEN Dashboard SHALL 不显示 FamilyOverviewCard
3. WHEN FamilyOverviewCard 加载数据 THEN 组件 SHALL 显示加载骨架屏
4. WHEN 家庭概览数据加载失败 THEN 组件 SHALL 显示空状态提示
5. WHEN 用户点击"查看详情" THEN 系统 SHALL 导航到家庭账目页面

### 需求 2：家庭总资产展示

**用户故事：** 作为一个家庭成员，我希望能够看到家庭的总资产，以便了解家庭的整体财务实力。

#### 验收标准

1. WHEN 家庭概览加载完成 THEN FamilyOverviewCard SHALL 显示家庭总资产金额
2. THE 家庭总资产 SHALL 等于所有成员非信用账户余额之和
3. WHEN 信用账户余额为负（欠款）THEN 系统 SHALL 不将其计入总资产
4. WHEN 信用账户余额为正（还款超额）THEN 系统 SHALL 将其计入总资产
5. WHEN 用户查看资产详情 THEN 系统 SHALL 按账户类型和成员分组展示

### 需求 3：家庭收支统计

**用户故事：** 作为一个家庭成员，我希望能够看到家庭的月度收支统计，以便了解家庭的消费情况。

#### 验收标准

1. WHEN 家庭概览加载完成 THEN FamilyOverviewCard SHALL 显示本月家庭收入、支出和结余
2. THE 家庭收支统计 SHALL 基于成员加入时间计算（只统计成员加入后的交易）
3. WHEN 成员加入家庭后 THEN 系统 SHALL 只统计该成员加入日期之后的交易
4. WHEN 用户切换月份 THEN 系统 SHALL 重新计算该月的收支统计

### 需求 4：成员贡献展示

**用户故事：** 作为一个家庭成员，我希望能够看到各成员的收支贡献占比，以便了解家庭成员的财务贡献。

#### 验收标准

1. WHEN 家庭概览加载完成 THEN FamilyOverviewCard SHALL 显示成员贡献列表
2. THE 成员贡献 SHALL 包含成员昵称、支出金额和支出占比
3. WHEN 家庭有多个成员 THEN 系统 SHALL 按支出金额降序排列成员
4. THE 所有成员支出占比之和 SHALL 等于 100%（允许浮点误差 ±0.01）

### 需求 5：家庭账户列表

**用户故事：** 作为一个家庭成员，我希望能够查看所有家庭成员的账户信息，以便了解家庭资金分布。

#### 验收标准

1. WHEN 用户访问家庭资产详情 THEN 系统 SHALL 显示所有成员的账户列表
2. THE 账户列表 SHALL 按成员分组展示
3. WHEN 展示账户信息 THEN 系统 SHALL 显示账户名称、类型和余额
4. THE 系统 SHALL 显示每个成员的账户余额小计
5. THE 系统 SHALL 显示按账户类型汇总的金额

### 需求 6：家庭交易列表

**用户故事：** 作为一个家庭成员，我希望能够查看家庭所有成员的交易记录，以便了解家庭的消费明细。

#### 验收标准

1. WHEN 用户访问家庭账目页面 THEN 系统 SHALL 显示家庭交易列表
2. THE 交易列表 SHALL 包含所有成员加入后的交易记录
3. WHEN 展示交易记录 THEN 系统 SHALL 显示记录人、金额、分类、日期和备注
4. WHEN 用户筛选交易 THEN 系统 SHALL 支持按成员、分类、类型和日期范围筛选
5. WHEN 交易列表为空 THEN 系统 SHALL 显示空状态提示
6. THE 交易列表 SHALL 支持分页加载

### 需求 7：移动端适配

**用户故事：** 作为一个移动端用户，我希望家庭模块在手机上有良好的展示效果，以便随时查看家庭财务。

#### 验收标准

1. WHEN 用户在移动端访问家庭管理页面 THEN 系统 SHALL 使用移动端优化的布局
2. WHEN 用户在移动端访问家庭账目页面 THEN 系统 SHALL 使用卡片式交易列表
3. THE 移动端 SHALL 支持下拉刷新功能
4. THE 移动端 SHALL 使用 BottomSheet 替代 Dialog 进行表单操作
5. WHEN 移动端加载数据 THEN 系统 SHALL 显示适当的加载状态

### 需求 8：多家庭支持

**用户故事：** 作为一个用户，我可能加入多个家庭，希望能够在不同家庭之间切换查看。

#### 验收标准

1. WHEN 用户加入多个家庭 THEN FamilyOverviewCard SHALL 显示家庭选择器
2. WHEN 用户切换家庭 THEN 系统 SHALL 重新加载该家庭的概览数据
3. WHEN 用户只加入一个家庭 THEN 系统 SHALL 不显示家庭选择器
4. THE 系统 SHALL 记住用户上次选择的家庭
